

conn = oracledb.connect(user="your_user", password="your_pw", dsn="exp")

state = "NM"
year = 2022
quarter = 3
sectors = ["6244", "7225"]

placeholders = ', '.join([f':{i+4}' for i in range(len(sectors))])
sql = f""" SELECT *
FROM your_table
WHERE state = :1 AND year = :2 AND quarter = :3 AND sector IN ({placeholders})
"""

params = [state, year, quarter] + sectors
cursor = conn.cursor()
cursor.execute(sql, params)
rows = cursor.fetchall()
