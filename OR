import pandas as pd

def find_wage_naics_conflicts(df: pd.DataFrame) -> pd.DataFrame:
    """
    Return all rows for ID/YR/QTR/WAGE combinations
    that have more than one distinct NAICS2.
    """
    # count distinct NAICS2 per ID, year, quarter, and wage
    grp = (
        df
        .groupby(['ID', 'YR', 'QTR', 'WAGE'], as_index=False)
        .agg(naics2_count=('NAICS2', 'nunique'))
    )

    # keep only those combinations with >1 distinct NAICS2
    conflicts = grp[grp['naics2_count'] > 1]

    # join back to the original df to get all offending rows
    result = df.merge(
        conflicts[['ID', 'YR', 'QTR', 'WAGE']],
        on=['ID', 'YR', 'QTR', 'WAGE'],
        how='inner'
    )
    return result

# assume `df` is your DataFrame
conflicting_rows = find_wage_naics_conflicts(df)
print(conflicting_rows)
