import pandas as pd

# Sample DataFrame to mimic the structure
data = {
    "ID": range(1, 28),
    "WAGE_DIFF": [1234.567, -500.45, 789.3] * 9,
    "COUNT_A": [10, 20, 30] * 9,
    "WAGE_CHANGE": [5000.345, -200.22, 100.55] * 9,
    "COUNT_B": [5, 15, 25] * 9,
}

# Creating DataFrame
df = pd.DataFrame(data)

# Formatting function
def format_dataframe(df):
    formatted_df = df.copy()
    
    # Apply formatting
    for col in formatted_df.columns:
        if "WAGE" in col:
            formatted_df[col] = formatted_df[col].apply(lambda x: f"${x:,.2f}")
        else:
            formatted_df[col] = formatted_df[col].astype(int)
    
    # Convert to HTML with styling
    styled_html = formatted_df.style.set_properties(**{
        'text-align': 'center'
    }).set_table_styles([{
        'selector': 'th, td',
        'props': [('text-align', 'center')]
    }]).to_html()

    return styled_html

# Get formatted HTML
html_output = format_dataframe(df)
html_output



from weasyprint import HTML

# Define the output PDF file path
pdf_file_path = "/mnt/data/formatted_table.pdf"

# Convert HTML to PDF
HTML(string=html_output).write_pdf(pdf_file_path)

# Provide the download link
pdf_file_path
