combo_rank = (df.groupby(['CATEGORY_1','CATEGORY_2','CATEGORY_3'])['WAGE']
                .mean()
                .reset_index(name='avg_wage')
                .sort_values('avg_wage', ascending=False))

combo_rank['combo_rank'] = combo_rank['avg_wage'].rank(method='dense', ascending=False)

combo_rank
