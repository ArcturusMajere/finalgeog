aws sts get-caller-identity
aws configure list


export AWS_SHARED_CREDENTIALS_FILE=/path/to/my_creds.txt
aws s3 ls --profile work
export AWS_PROFILE=work


export AWS_ACCESS_KEY_ID=AKIA...
export AWS_SECRET_ACCESS_KEY=xxxx...
export AWS_SESSION_TOKEN=token   # if needed


stats=(df.groupby(["category_1","category_2"],dropna=False)
         .agg(id_count=("id","nunique"),wage_mean=("wage","mean"),hours_mean=("hours","mean"))
         .reset_index())

df2=df.merge(stats,on=["category_1","category_2"],how="left")
