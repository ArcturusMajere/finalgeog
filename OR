import os
import saspy

sas = saspy.SASsession()

input_dir = r"C:\path\to\csv_directory"
output_dir = r"C:\path\to\output_sas_directory"

os.makedirs(output_dir, exist_ok=True)

sas.saslib("out", path=output_dir)

for fname in os.listdir(input_dir):
    if fname.lower().endswith(".csv"):
        csv_path = os.path.join(input_dir, fname)
        table = os.path.splitext(fname)[0]
        sas.read_csv(csv_path, table=table, libref="work")
        sas.submit(f"""
data out.{table};
    set work.{table};
run;
""")
        print(f"Converted {fname} to {os.path.join(output_dir, table + '.sas7bdat')}")
