import polars as pl
import oracledb

def fetch_with_params(query: str, params: dict, conn) -> pl.DataFrame:
    try:
        with conn.cursor() as cursor:
            cursor.execute(query, params)
            rows = cursor.fetchall()
            columns = [col[0] for col in cursor.description]
            df = pl.DataFrame(rows, schema=columns)
            return df
    except oracledb.Error as e:
        print("Database error:", e)
        return pl.DataFrame()




query = """
SELECT BLS_ID, UI, state_col, year_col, quarter_col
FROM your_table
WHERE state_col = :state
  AND year_col = :year
  AND quarter_col = :quarter
"""

params = {
    "state": "NM",
    "year": 2022,
    "quarter": 4
}

with oracledb.connect(user=username, password=password, dsn=dsn) as conn:
    result_df = fetch_with_params(query, params, conn)
