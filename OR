

def dupesum(df,id_col="id",wage_col="WAGE"):
    if id_col not in df.columns:
        raise ValueError(f"Missing column: {id_col}")
    if wage_col not in df.columns:
        raise ValueError(f"Missing column: {wage_col}")
    df=df.copy()
    df[wage_col]=pd.to_numeric(df[wage_col],errors="coerce").fillna(0)
    agg={}
    for c in df.columns:
        if c==wage_col:
            agg[c]="sum"
        elif c==id_col:
            agg[c]="first"
        else:
            agg[c]="first"
    out=df.groupby(id_col,as_index=False).agg(agg)
    return out
dupesum(df,"ID","WAGE")
