from concurrent.futures import ThreadPoolExecutor
import pandas as pd

def collect_counts_multithreaded(STATES):
    def task(state):
        count = DOM(state)
        return {'state': state, 'count': count}
    
    with ThreadPoolExecutor() as executor:
        results = list(executor.map(task, STATES))
    
    return pd.DataFrame(results)
