from concurrent.futures import ThreadPoolExecutor
import pandas as pd

def collect_dom_counts(STATES, YEARS, QTRS):
    def task(params):
        state, year, qtr = params
        count = DOM(state, year, qtr)
        return {'state': state, 'yr_qtr': f"{year}-{qtr}", 'count': count}
    
    params_list = [(s, y, q) for s in STATES for y in YEARS for q in QTRS]
    
    with ThreadPoolExecutor() as executor:
        results = list(executor.map(task, params_list))
    
    return pd.DataFrame(results)


STATES = ['CA', 'NY', 'TX']
YEARS = range(2020, 2024)
QTRS = [1, 2, 3, 4]

df = collect_dom_counts(STATES, YEARS, QTRS)
