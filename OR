
# Add indicator column to df2 before join
df2 = df2.with_columns(pl.lit(True).alias("matched"))

# Left join
joined = df1.join(df2, on=["UI", "state"], how="left")

# Fill nulls in 'matched' with False to indicate no match
joined = joined.with_columns(
    pl.col("matched").fill_null(False)
)

print(joined)
