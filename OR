

def collectorl(root_dir, output_file):
    writer = pd.ExcelWriter(output_file, engine="openpyxl")
    for dirpath, _, filenames in os.walk(root_dir):
        for f in filenames:
            if f.lower().endswith(".csv"):
                file_path = os.path.join(dirpath, f)
                try:
                    df = pd.read_csv(file_path)
                except Exception as e:
                    print(f"Skipping {file_path}: {e}")
                    continue
                sheet_name = os.path.splitext(f)[0][:31]  # Excel limit
                df.to_excel(writer, sheet_name=sheet_name, index=False)
    writer.close()
